* { box-sizing: border-box; }
:root {
	--bg: #070a12;
	--bg2: #0b0e13;
	--panel: rgba(18, 22, 32, 0.6);
	--panel-border: rgba(255,255,255,0.12);
	--muted: #8b95ab;
	--text: #e9eef7;
	--accent: #ffd644;
	--accent-2: #7f8cff; /* violet */
	--grid: rgba(255,255,255,0.06);
	--hl: rgba(255, 214, 68, 0.28);
}
html, body { height: 100%; }
body {
	margin: 0;
	font-family: 'Space Grotesk', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
	background: radial-gradient(1200px 60% at 20% -10%, #19203a 0%, transparent 60%),
		radial-gradient(900px 70% at 120% 20%, #12172a 0%, transparent 55%),
		var(--bg);
	color: var(--text);
}
body::before {
	content: '';
	position: fixed; inset: 0; pointer-events: none; z-index: 0;
	background:
		radial-gradient(circle at 20% 30%, rgba(255,255,255,0.07) 0 1px, transparent 2px) 0 0/140px 140px,
		radial-gradient(circle at 70% 60%, rgba(255,255,255,0.05) 0 1px, transparent 2px) 0 0/220px 220px;
	opacity: 0.45;
}

.topbar {
	position: sticky; top: 0; z-index: 10;
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: 12px 16px;
	background: linear-gradient(180deg, rgba(12,16,27,0.85), rgba(12,16,27,0.6));
	backdrop-filter: saturate(120%) blur(8px);
	border-bottom: 1px solid rgba(255,255,255,0.08);
	box-shadow: 0 6px 24px rgba(0,0,0,0.35);
}
.brand { font-family: 'Orbitron', 'Space Grotesk', ui-sans-serif; font-weight: 700; letter-spacing: 1.2px; text-transform: uppercase; background: linear-gradient(90deg, #8ea2ff, #56e1ff, #ffd644); -webkit-background-clip: text; background-clip: text; color: transparent; }
.top-actions { display: flex; gap: 8px; }

button {
	appearance: none;
	border: 1px solid var(--panel-border);
	background: linear-gradient(180deg, #1e2440, #191f35);
	color: var(--text);
	padding: 10px 14px;
	border-radius: 12px;
	cursor: pointer;
	font-weight: 700;
	letter-spacing: 0.2px;
	transition: transform 120ms ease, box-shadow 120ms ease, background 200ms ease;
	box-shadow: 0 4px 18px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.06);
}
button.primary { background: linear-gradient(180deg, #3540a8, #2a335e); border-color: #4955d9; box-shadow: 0 6px 20px rgba(73,85,217,0.35), inset 0 1px 0 rgba(255,255,255,0.06); }
button.secondary { background: linear-gradient(180deg, #1a2031, #141a29); }
button.large { font-size: 22px; padding: 14px 18px; border-radius: 14px; }
button:hover { transform: translateY(-1px); box-shadow: 0 10px 28px rgba(0,0,0,0.45); }
button:active { transform: translateY(0); }
button:disabled { opacity: 0.6; cursor: not-allowed; }
button:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }

select {
	appearance: none;
	border: 1px solid var(--panel-border);
	background: #0e1322 url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%23e9eef7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>') no-repeat right 10px center / 16px 16px;
	color: var(--text);
	padding: 10px 36px 10px 12px;
	border-radius: 12px;
	font-weight: 600;
}

.layout {
	display: grid;
	grid-template-columns: 1fr 360px;
	gap: 16px;
	height: calc(100vh - 58px);
	position: relative;
	z-index: 1;
}
.board-panel { display: grid; place-items: center; padding: 10px; }
#board { width: 100%; height: 100%; background: #05070b; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.05), 0 0 60px rgba(127,140,255,0.25) inset; border: 1px solid rgba(255,255,255,0.08); }

.hud { padding: 14px 14px 22px 0; overflow: auto; }
.panel {
	background: var(--panel);
	backdrop-filter: blur(10px) saturate(120%);
	border: 1px solid var(--panel-border);
	border-radius: 16px;
	padding: 16px;
	margin-bottom: 16px;
	box-shadow: 0 10px 30px rgba(0,0,0,0.35);
}
.panel.small h3 { margin-bottom: 6px; }
.panel h3 { margin: 0 0 12px; font-size: 12px; color: var(--muted); font-weight: 800; letter-spacing: 1px; text-transform: uppercase; }
.controls { display: grid; grid-template-columns: 1fr auto; grid-template-areas: 'roll die' 'end end'; gap: 12px; }
.controls #btnRoll { grid-area: roll; }
.controls #rollResult { grid-area: die; align-self: center; }
.controls #btnEnd { grid-area: end; justify-self: stretch; }
.die { font-family: 'Orbitron', 'Space Grotesk', ui-sans-serif; font-size: 20px; font-weight: 700; min-width: 48px; text-align: center; padding: 10px 12px; border-radius: 10px; background: #0e1322; border: 1px solid rgba(255,255,255,0.12); box-shadow: inset 0 1px 0 rgba(255,255,255,0.06); }
.die.bump { animation: bump 320ms ease; }
.die.rolling { animation: roll-spin 700ms ease-in-out; box-shadow: 0 0 0 1px rgba(255,255,255,0.12) inset, 0 0 24px rgba(127,140,255,0.5); }
@keyframes bump { 0% { transform: translateY(0) scale(1); } 40% { transform: translateY(-2px) scale(1.15); } 100% { transform: translateY(0) scale(1); } }
@keyframes roll-spin { 0% { transform: rotate(0deg) scale(1); } 50% { transform: rotate(360deg) scale(1.2); } 100% { transform: rotate(720deg) scale(1); } }

.scoreboard { list-style: none; margin: 0; padding: 0; display: grid; gap: 8px; }
.scoreboard li { display: grid; grid-template-columns: 18px 1fr auto; align-items: center; gap: 10px; padding: 8px 10px; background: rgba(8,12,22,0.7); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; box-shadow: inset 0 1px 0 rgba(255,255,255,0.04); }
.scoreboard li.active { outline: 2px solid var(--accent); box-shadow: 0 0 0 3px rgba(255,214,68,0.18) inset, 0 8px 22px rgba(0,0,0,0.35); }
.score-swatch { width: 14px; height: 14px; border-radius: 3px; border: 1px solid rgba(255,255,255,0.25); }

.legend { list-style: none; margin: 0; padding: 0; display: grid; gap: 8px; }
.legend li { display: flex; align-items: center; gap: 8px; color: var(--muted); }
.legend-swatch { display: inline-block; width: 16px; height: 16px; border-radius: 4px; border: 1px solid rgba(255,255,255,0.25); box-shadow: inset 0 1px 0 rgba(255,255,255,0.08); }
.swatch-asteroid { background: #3a3f50; }
.swatch-boost { background: #ffd644; }
.swatch-portal { background: #b67eff; }
.swatch-flag { background: #ff5757; }
.swatch-highlight { background: var(--hl); }

.modal { position: fixed; inset: 0; display: grid; place-items: center; background: rgba(0,0,0,0.5); backdrop-filter: blur(6px); z-index: 1000; }
.modal.hidden { display: none; }
.modal-content { width: min(860px, 92vw); background: rgba(18,22,32,0.8); border: 1px solid rgba(255,255,255,0.14); border-radius: 16px; padding: 18px; box-shadow: 0 10px 60px rgba(0,0,0,0.6), 0 0 0 1px rgba(255,255,255,0.08) inset; }
.modal-content.rules { max-height: 80vh; overflow: auto; }
.modal-actions { display: flex; justify-content: flex-end; gap: 8px; margin-top: 14px; }

.players-config { display: grid; gap: 12px; margin-top: 12px; }
.player-row { display: grid; grid-template-columns: 1fr 160px 120px; gap: 12px; }
.player-row input[type="text"] { width: 100%; padding: 12px 14px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.18); background: #0e1322; color: var(--text); }
.player-row input[type="color"] { width: 100%; height: 42px; border: 1px solid rgba(255,255,255,0.18); border-radius: 12px; padding: 0; background: #0e1322; }

.rules-copy p { color: var(--text); line-height: 1.5; }
.rules-copy ul { margin: 0; padding-left: 18px; display: grid; gap: 8px; }
.rules-copy li { color: var(--muted); }

/* Online lobby */
.lobby-content { max-width: 600px; }
.lobby-choice { display: grid; gap: 24px; }
.lobby-form { display: grid; gap: 12px; padding: 16px; background: rgba(8,12,22,0.7); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; }
.lobby-form h3 { margin: 0 0 12px; color: var(--accent); font-size: 16px; }
.lobby-form input[type="text"] { width: 100%; padding: 12px 14px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.18); background: #0e1322; color: var(--text); }
.lobby-form input[type="color"] { width: 100%; height: 42px; border: 1px solid rgba(255,255,255,0.18); border-radius: 12px; padding: 0; background: #0e1322; }
.divider { text-align: center; color: var(--muted); font-weight: 600; position: relative; }
.divider::before, .divider::after { content: ''; position: absolute; top: 50%; width: 40%; height: 1px; background: rgba(255,255,255,0.12); }
.divider::before { left: 0; }
.divider::after { right: 0; }

.room-lobby { display: grid; gap: 20px; }
.room-header { text-align: center; padding: 16px; background: rgba(8,12,22,0.7); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; }
.room-code-display { color: var(--accent); font-family: 'Orbitron', monospace; font-size: 24px; letter-spacing: 4px; }
.players-list { background: rgba(8,12,22,0.7); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; padding: 16px; }
.players-list h4 { margin: 0 0 12px; color: var(--muted); font-size: 14px; }
.lobby-players { list-style: none; margin: 0; padding: 0; display: grid; gap: 8px; }
.lobby-players li { display: grid; grid-template-columns: 24px 1fr auto auto; align-items: center; gap: 12px; padding: 10px; background: rgba(18,22,32,0.8); border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; }
.lobby-players li.host { border-color: var(--accent); }
.lobby-players li.ready { background: rgba(73,212,108,0.1); }
.player-color { width: 20px; height: 20px; border-radius: 4px; border: 2px solid rgba(255,255,255,0.4); }
.player-badge { padding: 4px 8px; background: rgba(255,255,255,0.1); border-radius: 6px; font-size: 12px; font-weight: 600; }
.player-badge.host { background: var(--accent); color: var(--bg); }
.player-badge.ready { background: rgba(73,212,108,0.3); }
.lobby-actions { display: flex; gap: 12px; justify-content: center; }
.lobby-status { text-align: center; color: var(--muted); margin: 0; }
.error-message { padding: 12px; background: rgba(255,87,87,0.2); border: 1px solid rgba(255,87,87,0.4); border-radius: 8px; color: #ff5757; text-align: center; }

.room-code { display: inline-block; padding: 4px 12px; background: rgba(255,214,68,0.2); border: 1px solid var(--accent); border-radius: 8px; color: var(--accent); font-family: 'Orbitron', monospace; letter-spacing: 2px; }

.hidden { display: none !important; }
.muted { color: var(--muted); }

/* Mobile optimizations */
@media (max-width: 768px) {
	body { overflow-x: hidden; }
	.topbar { padding: 8px 12px; }
	.brand { font-size: 14px; letter-spacing: 0.8px; }
	.top-actions { gap: 4px; }
	.top-actions button { padding: 8px 10px; font-size: 12px; }
	.room-code { font-size: 12px; padding: 2px 8px; }
	
	/* Portrait mode */
	.layout { 
		grid-template-columns: 1fr; 
		height: calc(100vh - 50px);
		gap: 8px;
	}
	.board-panel { 
		height: 50vh; 
		padding: 5px;
	}
	.hud { 
		padding: 8px;
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 8px;
		overflow-y: auto;
		max-height: calc(50vh - 16px);
	}
	.panel { 
		margin-bottom: 8px; 
		padding: 12px;
	}
	.panel h3 { font-size: 11px; margin-bottom: 8px; }
	.controls { gap: 8px; }
	.controls button { font-size: 14px; padding: 10px; }
	.die { font-size: 18px; min-width: 40px; }
	.scoreboard li { padding: 6px 8px; font-size: 13px; }
	.legend { font-size: 12px; gap: 6px; }
	.legend-swatch { width: 14px; height: 14px; }
	
	/* Landscape mode */
	@media (orientation: landscape) {
		.layout {
			grid-template-columns: 1fr 340px;
			height: calc(100vh - 50px);
		}
		.board-panel { 
			height: auto;
			padding: 8px;
		}
		.hud {
			display: block;
			overflow-y: auto;
			max-height: calc(100vh - 66px);
		}
	}
}

@media (max-width: 480px) {
	.modal-content { 
		width: 95vw; 
		padding: 14px;
		max-height: 90vh;
		overflow-y: auto;
	}
	.lobby-form input[type="text"] { font-size: 16px; } /* Prevent zoom on iOS */
	.lobby-players li { 
		grid-template-columns: 20px 1fr auto;
		font-size: 13px;
		padding: 8px;
	}
	.player-badge { font-size: 10px; padding: 2px 6px; }
}

/* Touch-friendly board */
@media (pointer: coarse) {
	#board { touch-action: manipulation; }
	button { min-height: 44px; } /* iOS touch target size */
	.controls button { min-width: 80px; }
}

/* Move animation trail */
@keyframes moveTrail {
	0% { opacity: 0.8; transform: scale(1); }
	100% { opacity: 0; transform: scale(1.5); }
}

.move-trail {
	position: absolute;
	pointer-events: none;
	border-radius: 50%;
	background: radial-gradient(circle, rgba(255,214,68,0.6), transparent);
	animation: moveTrail 1s ease-out forwards;
}
